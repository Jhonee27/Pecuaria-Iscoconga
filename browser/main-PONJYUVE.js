import{a as p}from"./chunk-WIXQQANE.js";import{a as y,b as j,c as d,d as N,e as T,f as F,g as D}from"./chunk-BTAZEGTB.js";import{a as z}from"./chunk-RTPLDOJU.js";import{Aa as b,Ga as w,La as C,S as v,Tb as U,W as s,Wa as f,Wb as O,X as k,Xa as n,Ya as r,Za as o,aa as S,ab as I,ba as _,bb as M,cb as x,cc as L,dc as E,hb as R,jb as a,kb as P,lb as A,va as c}from"./chunk-W5R6ALBK.js";var l=class e{constructor(i,t){this.authService=i;this.router=t}canActivate(){return this.authService.isAuthenticated()?!0:(this.router.navigate(["/login"]),!1)}static \u0275fac=function(t){return new(t||e)(s(p),s(d))};static \u0275prov=v({token:e,factory:e.\u0275fac,providedIn:"root"})};var u=class e{constructor(i,t){this.authService=i;this.router=t}canActivate(i){let t=this.authService.getCurrentUser(),m=i.data.roles;return t?!m||m.includes(t.role)?!0:(this.router.navigate(["/unauthorized"]),!1):(this.router.navigate(["/login"]),!1)}static \u0275fac=function(t){return new(t||e)(s(p),s(d))};static \u0275prov=v({token:e,factory:e.\u0275fac,providedIn:"root"})};var $=[{path:"",redirectTo:"/login",pathMatch:"full"},{path:"login",loadComponent:()=>import("./chunk-7VAS6TRW.js").then(e=>e.LoginComponent)},{path:"dashboard",loadComponent:()=>import("./chunk-P7MXOH2Y.js").then(e=>e.DashboardComponent),canActivate:[l]},{path:"merchants",loadComponent:()=>import("./chunk-CR3CUXLI.js").then(e=>e.MerchantListComponent),canActivate:[l]},{path:"movements",loadComponent:()=>import("./chunk-XOBXIYTH.js").then(e=>e.MovementFormComponent),canActivate:[l]},{path:"profile",loadComponent:()=>import("./chunk-VV6IPOMP.js").then(e=>e.ProfileComponent),canActivate:[l]},{path:"settings",loadComponent:()=>import("./chunk-MNV2ZFES.js").then(e=>e.SettingsComponent),canActivate:[l]},{path:"admin/users",loadComponent:()=>import("./chunk-5AAJBKZV.js").then(e=>e.UserManagementComponent),canActivate:[l,u],data:{roles:["admin"]}},{path:"statistics",loadComponent:()=>import("./chunk-YYQU35W2.js").then(e=>e.StatisticsComponent),canActivate:[l,u],data:{roles:["admin"]}},{path:"unauthorized",loadComponent:()=>import("./chunk-YHZNURVE.js").then(e=>e.UnauthorizedComponent)},{path:"**",redirectTo:"/login"}];var B=(e,i)=>{let m=k(p).getToken();if(console.log("\u{1F510} Interceptor - Token:",m?"Presente":"No presente"),console.log("\u{1F510} Interceptor - URL:",e.url),m&&e.url.includes("/api/")){let h=e.clone({setHeaders:{Authorization:`Bearer ${m}`}});return console.log("\u{1F510} Interceptor - Headers agregados"),i(h)}return console.log("\u{1F510} Interceptor - Sin token, request normal"),i(e)};var J={providers:[F($),L(E([B]))]};function K(e,i){e&1&&(n(0,"li",11)(1,"a",34),o(2,"i",35),a(3," Estad\xEDsticas "),r()())}function Q(e,i){e&1&&(n(0,"li",11)(1,"a",36),o(2,"i",37),a(3," Gesti\xF3n de Usuarios "),r()())}function W(e,i){if(e&1){let t=I();n(0,"nav",3)(1,"div",4)(2,"a",5),o(3,"i",6),a(4),r(),n(5,"button",7),o(6,"span",8),r(),n(7,"div",9)(8,"ul",10)(9,"li",11)(10,"a",12),o(11,"i",13),a(12," Dashboard "),r()(),n(13,"li",11)(14,"a",14),o(15,"i",15),a(16," Comerciantes "),r()(),n(17,"li",11)(18,"a",16),o(19,"i",17),a(20," Movimientos "),r()(),C(21,K,4,0,"li",18)(22,Q,4,0,"li",18),r(),n(23,"ul",19)(24,"li",20)(25,"a",21),o(26,"i",22),n(27,"div",23)(28,"span",24),a(29),r(),n(30,"small",25),a(31),r()()(),n(32,"ul",26)(33,"li")(34,"a",27),o(35,"i",28),a(36," Mi Perfil "),r()(),n(37,"li")(38,"a",29),o(39,"i",30),a(40," Configuraci\xF3n "),r()(),n(41,"li"),o(42,"hr",31),r(),n(43,"li")(44,"a",32),M("click",function(){S(t);let h=x();return _(h.logout())}),o(45,"i",33),a(46," Cerrar Sesi\xF3n "),r()()()()()()()()}if(e&2){let t=x();c(4),A(" ",t.appName," "),c(17),f("ngIf",(t.currentUser==null?null:t.currentUser.role)==="admin"),c(),f("ngIf",(t.currentUser==null?null:t.currentUser.role)==="admin"),c(7),P(t.currentUser==null?null:t.currentUser.email),c(2),A(" ",(t.currentUser==null?null:t.currentUser.role)==="admin"?"Administrador":"Personal"," ")}}var g=class e{constructor(i,t){this.authService=i;this.router=t}appName=z.appName;currentUser=null;ngOnInit(){this.loadCurrentUser(),this.authService.currentUser$.subscribe(i=>{this.currentUser=i})}isAuthenticated(){return this.authService.isAuthenticated()}logout(){this.authService.logout(),this.router.navigate(["/login"])}loadCurrentUser(){this.currentUser=this.authService.getCurrentUser()}static \u0275fac=function(t){return new(t||e)(b(p),b(d))};static \u0275cmp=w({type:e,selectors:[["app-root"]],decls:4,vars:3,consts:[[1,"app-container"],["class","navbar navbar-expand-lg navbar-dark bg-primary shadow-sm",4,"ngIf"],[1,"main-content"],[1,"navbar","navbar-expand-lg","navbar-dark","bg-primary","shadow-sm"],[1,"container-fluid","px-4"],["routerLink","/dashboard",1,"navbar-brand","fw-bold","d-flex","align-items-center"],[1,"bi","bi-building","me-2","fs-4"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarNav","aria-controls","navbarNav","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarNav",1,"collapse","navbar-collapse"],[1,"navbar-nav","me-auto","mb-2","mb-lg-0"],[1,"nav-item"],["routerLink","/dashboard","routerLinkActive","active",1,"nav-link"],[1,"bi","bi-speedometer2","me-2"],["routerLink","/merchants","routerLinkActive","active",1,"nav-link"],[1,"bi","bi-people","me-2"],["routerLink","/movements","routerLinkActive","active",1,"nav-link"],[1,"bi","bi-truck","me-2"],["class","nav-item",4,"ngIf"],[1,"navbar-nav"],[1,"nav-item","dropdown"],["href","#","role","button","data-bs-toggle","dropdown",1,"nav-link","dropdown-toggle","d-flex","align-items-center"],[1,"bi","bi-person-circle","fs-5","me-2"],[1,"d-flex","flex-column","text-start"],[1,"fw-semibold"],[1,"badge","bg-light","text-dark"],[1,"dropdown-menu","dropdown-menu-end","shadow-sm"],["routerLink","/profile",1,"dropdown-item"],[1,"bi","bi-person","me-2","text-primary"],["routerLink","/settings",1,"dropdown-item"],[1,"bi","bi-gear","me-2","text-secondary"],[1,"dropdown-divider"],[1,"dropdown-item","text-danger","fw-semibold",2,"cursor","pointer",3,"click"],[1,"bi","bi-box-arrow-right","me-2"],["routerLink","/statistics","routerLinkActive","active",1,"nav-link"],[1,"bi","bi-bar-chart-line","me-2"],["routerLink","/admin/users","routerLinkActive","active",1,"nav-link"],[1,"bi","bi-person-gear","me-2"]],template:function(t,m){t&1&&(n(0,"div",0),C(1,W,47,5,"nav",1),n(2,"main",2),o(3,"router-outlet"),r()()),t&2&&(c(),f("ngIf",m.isAuthenticated()),c(),R("authenticated",m.isAuthenticated()))},dependencies:[D,j,N,T,O,U],styles:[".app-container[_ngcontent-%COMP%]{background-color:#f8f9fa;min-height:100vh;display:flex;flex-direction:column}.navbar[_ngcontent-%COMP%]{background:linear-gradient(90deg,#004aad,#007bff);padding:.8rem 1rem;border-bottom:1px solid rgba(255,255,255,.15);-webkit-backdrop-filter:blur(6px);backdrop-filter:blur(6px)}.navbar[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{color:#fff!important;font-weight:500;transition:all .2s ease-in-out}.navbar[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover, .navbar[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{color:#ffe600!important;text-shadow:0 0 6px rgba(255,255,255,.5)}.navbar-brand[_ngcontent-%COMP%]{color:#fff!important;font-weight:700;letter-spacing:.5px}.dropdown-menu[_ngcontent-%COMP%]{border-radius:10px;padding:.5rem 0;font-size:.95rem}.main-content[_ngcontent-%COMP%]{flex:1;padding:2rem;transition:all .3s ease}.main-content.authenticated[_ngcontent-%COMP%]{margin-top:0}@media (max-width: 991px){.navbar[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{padding:.5rem 1rem}.main-content[_ngcontent-%COMP%]{padding:1rem}}"]})};y(g,J).catch(e=>console.error(e));
